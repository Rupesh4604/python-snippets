import pandas as pd

print(pd.__version__)
# 2.1.4

df = pd.DataFrame({'A': [1, 3, 5], 'B': [10, 30, 50], 'C': [100, 300, 500]},
                  index=pd.date_range('2023-12-01', '2023-12-05', freq='2D'))
print(df)
#             A   B    C
# 2023-12-01  1  10  100
# 2023-12-03  3  30  300
# 2023-12-05  5  50  500

print(df.index)
# DatetimeIndex(['2023-12-01', '2023-12-03', '2023-12-05'], dtype='datetime64[ns]', freq='2D')

new_dt_index = pd.date_range('2023-12-01', '2023-12-05', freq='12H')
print(new_dt_index)
# DatetimeIndex(['2023-12-01 00:00:00', '2023-12-01 12:00:00',
#                '2023-12-02 00:00:00', '2023-12-02 12:00:00',
#                '2023-12-03 00:00:00', '2023-12-03 12:00:00',
#                '2023-12-04 00:00:00', '2023-12-04 12:00:00',
#                '2023-12-05 00:00:00'],
#               dtype='datetime64[ns]', freq='12H')

print(df.reindex(index=new_dt_index))
#                        A     B      C
# 2023-12-01 00:00:00  1.0  10.0  100.0
# 2023-12-01 12:00:00  NaN   NaN    NaN
# 2023-12-02 00:00:00  NaN   NaN    NaN
# 2023-12-02 12:00:00  NaN   NaN    NaN
# 2023-12-03 00:00:00  3.0  30.0  300.0
# 2023-12-03 12:00:00  NaN   NaN    NaN
# 2023-12-04 00:00:00  NaN   NaN    NaN
# 2023-12-04 12:00:00  NaN   NaN    NaN
# 2023-12-05 00:00:00  5.0  50.0  500.0

print(df.reindex(index=new_dt_index, method='ffill'))
#                      A   B    C
# 2023-12-01 00:00:00  1  10  100
# 2023-12-01 12:00:00  1  10  100
# 2023-12-02 00:00:00  1  10  100
# 2023-12-02 12:00:00  1  10  100
# 2023-12-03 00:00:00  3  30  300
# 2023-12-03 12:00:00  3  30  300
# 2023-12-04 00:00:00  3  30  300
# 2023-12-04 12:00:00  3  30  300
# 2023-12-05 00:00:00  5  50  500

print(df.reindex(index=new_dt_index).interpolate(method='time'))
#                        A     B      C
# 2023-12-01 00:00:00  1.0  10.0  100.0
# 2023-12-01 12:00:00  1.5  15.0  150.0
# 2023-12-02 00:00:00  2.0  20.0  200.0
# 2023-12-02 12:00:00  2.5  25.0  250.0
# 2023-12-03 00:00:00  3.0  30.0  300.0
# 2023-12-03 12:00:00  3.5  35.0  350.0
# 2023-12-04 00:00:00  4.0  40.0  400.0
# 2023-12-04 12:00:00  4.5  45.0  450.0
# 2023-12-05 00:00:00  5.0  50.0  500.0

new_index = ['2023-12-01', '2023-12-02', '2023-12-03']

print(df.reindex(index=new_index))
#               A     B      C
# 2023-12-01  1.0  10.0  100.0
# 2023-12-02  NaN   NaN    NaN
# 2023-12-03  3.0  30.0  300.0

print(df.reindex(index=new_index).index)
# Index(['2023-12-01', '2023-12-02', '2023-12-03'], dtype='object')

print(df.reindex(index=new_index, method='bfill'))
#             A   B    C
# 2023-12-01  1  10  100
# 2023-12-02  3  30  300
# 2023-12-03  3  30  300

# print(df.reindex(index=new_index).interpolate(method='time'))
# ValueError: time-weighted interpolation only works on Series or DataFrames with a DatetimeIndex

df2 = pd.DataFrame({'A': [1, 1, 1, 1, 1], 'C': [100, 100, 100, 100, 100]},
                   index=pd.date_range('2023-12-01', '2023-12-05', freq='D'))
print(df2)
#             A    C
# 2023-12-01  1  100
# 2023-12-02  1  100
# 2023-12-03  1  100
# 2023-12-04  1  100
# 2023-12-05  1  100

print(df.reindex_like(df2))
#               A      C
# 2023-12-01  1.0  100.0
# 2023-12-02  NaN    NaN
# 2023-12-03  3.0  300.0
# 2023-12-04  NaN    NaN
# 2023-12-05  5.0  500.0

print(df.reindex_like(df2).interpolate(method='time'))
#               A      C
# 2023-12-01  1.0  100.0
# 2023-12-02  2.0  200.0
# 2023-12-03  3.0  300.0
# 2023-12-04  4.0  400.0
# 2023-12-05  5.0  500.0
